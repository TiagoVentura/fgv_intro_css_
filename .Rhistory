main=colnames(resultado_hash)[5], cex.main=1)
# all
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$indegre, legend =c("Bolsonaro", "Anti-Bolsonaro"))
# CPI COVID
plot(V(net)$l1,V(net)$l2,pch=16,
col=V(net)$new.color,
cex=log(resultado_hash[,1]+1),
xlim=c(-160,140),ylim=c(-140,120), xlab="", ylab="",
main=colnames(resultado_hash)[1], cex.main=1)
# Mandetta Genocida
plot(V(net)$l1,V(net)$l2,pch=16,
col=V(net)$new.color, cex=log(resultado_hash[,5]+1),
xlim=c(-160,140),ylim=c(-140,120), xlab="", ylab="",
main=colnames(resultado_hash)[5], cex.main=1)
dag_tiago <- function(dag, caption=""){
# Turn DAG into a tidy data frame for plotting
model_1_tidy <-dag %>%
tidy_dagitty() %>%
node_status()   # Add column for exposure/outcome/latent
colnames(model_1_tidy)
status_colors <- c(exposure = "#0074D9", outcome = "#FF4136", latent = "grey50")
# Fancier graph
ggplot(model_1_tidy, aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_edges() +
geom_dag_point(aes(color = status)) +
geom_dag_label_repel(aes(label = name, fill = status), seed = 1234,
color = "white", fontface = "bold") +
scale_color_manual(values = status_colors, na.value = "grey20") +
scale_fill_manual(values = status_colors, na.value = "grey20") +
guides(color = FALSE, fill = FALSE) +
theme_dag() +
labs(title = caption)
}
status_colors <- c(exposure = "#0074D9", outcome = "#FF4136", latent = "grey50")
model1 <- dagify(y~x+z,
x~z,
outcome="y",
exposure="x")
library(tidyverse)
library(dagitty)
library(ggdag)
library(causaleffect)
library(igraph)
library(latex2exp)
dag_tiago <- function(dag, caption=""){
# Turn DAG into a tidy data frame for plotting
model_1_tidy <-dag %>%
tidy_dagitty() %>%
node_status()   # Add column for exposure/outcome/latent
colnames(model_1_tidy)
status_colors <- c(exposure = "#0074D9", outcome = "#FF4136", latent = "grey50")
# Fancier graph
ggplot(model_1_tidy, aes(x = x, y = y, xend = xend, yend = yend)) +
geom_dag_edges() +
geom_dag_point(aes(color = status)) +
geom_dag_label_repel(aes(label = name, fill = status), seed = 1234,
color = "white", fontface = "bold") +
scale_color_manual(values = status_colors, na.value = "grey20") +
scale_fill_manual(values = status_colors, na.value = "grey20") +
guides(color = FALSE, fill = FALSE) +
theme_dag() +
labs(title = caption)
}
status_colors <- c(exposure = "#0074D9", outcome = "#FF4136", latent = "grey50")
model1 <- dagify(y~x+z,
x~z,
outcome="y",
exposure="x")
# Fancier graph
library(patchwork)
dag_tiago(model1)
ggdag_adjustment_set(model1) +
theme_minimal()
ggdag_adjustment_set(model2) +
theme_minimal()
model2 <- dagify(y~x + u,
x~z,
z~u,
outcome="y",
exposure="x",
latent="u")
model3 <- dagify(y~x+ z,
x~u,
z~u,
outcome="y",
exposure="x",
latent="u")
# Fancier graph
library(patchwork)
dag_tiago(model1)
dag_tiago(model2)
dag_tiago(model3)
status_colors <- c(exposure = "#0074D9", outcome = "#FF4136", latent = "grey50")
model4 <- dagify(y~m,
m~ z + x,
x ~ z,
outcome="y",
exposure="x")
model5 <- dagify(y~m,
m~ z + x,
x ~ u,
z~u,
outcome="y",
exposure="x",
latent = "u")
model6 <- dagify(y ~ m,
m ~ u + x,
z ~ u,
x~z,
outcome="y",
exposure="x",
latent = "u")
# Fancier graph
library(patchwork)
ggdag(model4)
ggdag(model1)
ggdag(model1) + theme_minimal()
model1 <- dagify(V~I+P,
P~I,
outcome="y",
exposure="x")
model1 <- dagify(V~I+P,
P~I)
# Fancier graph
library(patchwork)
ggdag(model1) + theme_minimal()
model1 <- dagify(Voto~Interesse+Pressao,
Pressao~Interesse)
# Fancier graph
library(patchwork)
ggdag(model1) + theme_minimal()
?ggdag
ggdag(vote_ca_dag, text = FALSE, use_labels = "label")
vote_ca_dag <- dagify(v ~ i + p,
p ~ i,
labels = c("i" = "Interesse por \n Política",
"v" = "Comparecimento",
"p" = "Pressão \nSocial"))
ggdag(vote_ca_dag, text = FALSE, use_labels = "label")
ggdag(vote_ca_dag, text = FALSE, use_labels = "label") +
theme_minimal()
xaringan::inf_mr()
ggdag(vote_ca_dag) +
theme_minimal()
xaringan::inf_mr()
vote_ca_dag <- dagify(v ~ i + p)
ggdag(vote_ca_dag) +
theme_minimal()
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",1,1),
nrow=3, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
vote_ca_dag <- dagify(v ~ i,
v~ p,
labels = c("i" = "Interesse por \n Política" ,
"v" = "Comparecimento",
"p" = "Pressão \nSocial"))
ggdag(vote_ca_dag) +
theme_minimal()
# model
model7 <- dagify(v~ P + i ,
coords=coords)
ggdag(model7) +
theme_minimal()
# model
model7 <- dagify(v~ p + i ,
coords=coords)
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",1,1),
nrow=3, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
# model
model7 <- dagify(v~ p + i ,
coords=coords)
ggdag(model7) +
theme_minimal()
coords
# model
model7 <- dagify(v ~ p ,
p ~ i,
coords=coords)
ggdag(model7) +
theme_minimal()
model7
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",2,1),
nrow=3, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
# model
model7 <- dagify(v ~ p ,
p ~ i,
coords=coords)
ggdag(model7) +
theme_minimal()
# model
model7 <- dagify(v ~ p + 1,
coords=coords)
ggdag(model7) +
theme_minimal()
# model
model7 <- dagify(v ~ p + i,
coords=coords)
ggdag(model7) +
theme_minimal()
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",2,2),
nrow=3, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
# model
model7 <- dagify(v ~ p + i,
coords=coords)
ggdag(model7) +
theme_minimal()
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",2,2,
"aleatorizacao", 3, 0),
nrow=3, ncol=3, byrow=T))
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",2,2,
"aleatorizacao", 3, 0),
nrow=4, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
# model
model7 <- dagify(v ~ p + i,
p~aleatorizacao,
coords=coords)
ggdag(model7) +
theme_minimal()
# model
model7 <- dagify(v ~ p + i,
p~aleatorizacao,
labels = c("a"= "Aleatorização"),
coords=coords)
ggdag(model7) +
theme_minimal()
ggdag(model7, text = FALSE, use_labels = "label") +
theme_minimal()
ggdag(model7, text = FALSE, use_labels = "label")
# model
model7 <- dagify(v ~ p + i,
p~a,
labels = c("a"= "Aleatorização"),
coords=coords)
ggdag(model7, text = FALSE, use_labels = "label")
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",2,2,
"a", 3, 0),
nrow=4, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
# model
model7 <- dagify(v ~ p + i,
p~a,
labels = c("a"= "Aleatorização",
"i" = "Interesse por \n Política" ,
"v" = "Comparecimento",
"p" = "Pressão \nSocial"),
coords=coords)
ggdag(model7, text = FALSE, use_labels = "label")
coords <- data.frame(matrix(c("v",1,1,
"p",0,2,
"i",2,2,
"a", 0, 3),
nrow=4, ncol=3, byrow=T))
colnames(coords) <- c("name","x","y")
# model
model7 <- dagify(v ~ p + i,
p~a,
labels = c("a"= "Aleatorização",
"i" = "Interesse por \n Política" ,
"v" = "Comparecimento",
"p" = "Pressão \nSocial"),
coords=coords)
ggdag(model7, text = FALSE, use_labels = "label")
blogdown::serve_site()
blogdown::serve_site()
library(tidyverse)
minha_url <- "https://www.xvideos.com/pornstar-channels/bruna_black#_tabVideos"
titulos <- read_html(minha_url) %>% html_nodes(css=".title a") %>% html_text() view(titulos)
titulos <- read_html(minha_url) %>% html_nodes(css=".title a") %>%
html_text()
library(rvest)
minha_url <- "https://www.xvideos.com/pornstar-channels/bruna_black#_tabVideos"
titulos <- read_html(minha_url) %>% html_nodes(css=".title a") %>%
html_text()
titulos
minha_url <- "https://www.xvideos.com/new/1"
titulos <- read_html(minha_url) %>% html_nodes(css=".title a") %>%
html_text()
titulos
minha_url
minha_url <- "https://www.xvideos.com/?k=flakael&p=4"
titulos <- read_html(minha_url) %>% html_nodes(css=".title a") %>%
html_text()
titulos
titulos <- read_html(minha_url) %>% html_nodes(css=".name") %>%
html_text()
titulos
titulos <- read_html(minha_url) %>% html_nodes(css=".title a ") %>%
html_text()
nome <- read_html(minha_url) %>% html_nodes(css=".name") %>%
html_text()
bind_cols(titulos, nome)
numero <- c("", 1:2)
minha_url_c <- paste0(minha_url, numero)
minha_url_c
minha_url <- "https://www.xvideos.com/?k=flakael&p="
numero <- c("", 1:2)
minha_url_c <- paste0(minha_url, numero)
minha_url_c
d <- list()
minha_url_c
d <- list()
for(i in 1:length(minha_url_c)){
source <- read_html(minha_url_c[i])
titulos <-  source %>% html_nodes(css=".title a ") %>%
html_text()
nome <- source %>% html_nodes(css=".name") %>%
html_text()
d[[i]] <- bind_cols(titulos, nome)
Sys.sleep(3)
}
d <- list()
d <- list()
for(i in 1:length(minha_url_c)){
source <- read_html(minha_url_c[i])
titulos <-  source %>% html_nodes(css=".title a ") %>%
html_text()
nome <- source %>% html_nodes(css=".name") %>%
html_text()
d[[i]] <- tibble(titulos, nome)
print("Coletando os Dados")
Sys.sleep(3)
}
d
xaringan::inf_mr()
xaringan::inf_mr()
path <- "/home/venturat/Dropbox/CalvoTiago/mlogitRedes"
output <- "./output/Bolsonaro/"
setwd(path)
library(tidyverse)
library(igraph)
library(data.table)
library(arm)
library(broom)
library(RColorBrewer)
library(KernSmooth)
rm(list=ls(all=TRUE))
##PLOT FUNCTION
my.den.plot <- function(l=l,new.color=new.color, ind=ind, legend){
#Numero efectivo de Comunidades
ENCG<-round(1/sum(round(table(new.color)/sum(table(new.color)),3)^2),2)
est <- bkde2D(l, bandwidth=c(10, 10))
#temp<-as.numeric(factor(new.color))+15
plot(l,cex=log(ind+1)/4, col=new.color, pch=16, xlim=c(-160,160),ylim=c(-160,140), xlab="", ylab="", axes=FALSE)
contour(est$x1, est$x2, est$fhat,  col = gray(.2), add=TRUE)
legend("topright", c(legend[1],legend[2]), pch = 17:18, col=c("#B2182B", "#2166AC"))
#text(-15000,25000,"Gobierno", cex=1.2, srt=0)
text(-140,115,paste("ENCG: ",ENCG,sep=""), cex=1, srt=0)
#text(jitter(l.rotated[,1],100),jitter(l.rotated[,2],100),my.label2, pos=3, cex=.6, col=gray(.1))
#segments(-5000,-40000,-5000,40000, col=2,lty=2)
#segments(-40000,-5000,40000,-5000, col=2,lty=2)
}
fomfE<- function(var=var, adjV=adjV,adjE=adjE){
stemp <- sapply(adjE, function(x) sum(var[x]))
mstemp <- sapply(adjV, function(x) mean(stemp[x]))
plot(log(stemp),log(mstemp),ylim=c(0,max(log(mstemp),na.rm=TRUE)), xlim=c(0,max(log(stemp),na.rm=TRUE)), pch=16, cex=.4, col=gray(.5), xlab="Friends", ylab="Friends of Friends")
abline(0,1, col=2, lty=2)
out<-cbind(stemp,mstemp)
}
auth_chart <- function(data, x, y, color, destination) {
x <- enquo(x)
y <- enquo(y)
ggplot(data, aes(x=reorder(!!x,
!!y),
y=!!y)) +
geom_histogram(stat="identity", width=.5, color="black",
fill=color) +
theme_minimal(base_size = 22) +
coord_flip() +
xlab("") + ylab("")
ggsave(filename = destination,
width = 12, height = 12, units = "in",
pointsize = 22, bg = "white")
}
memory.limit(size=50000)
path <- "C:/Users/Tiago Ventura/Dropbox/CalvoTiago/mlogitRedes"
list.files()
load("travelBan with  equilibrium Results.RData")
my.color <- brewer.pal(n=9, "RdBu")
##PLOT FUNCTION
my.den.plot <- function(l=l,new.color=new.color, ind=ind, legend, title){
#Numero efectivo de Comunidades
ENCG<-round(1/sum(round(table(new.color)/sum(table(new.color)),3)^2),2)
est <- bkde2D(l, bandwidth=c(10, 10))
#temp<-as.numeric(factor(new.color))+15
plot(l,cex=log(ind+1)/4, main=title, col=new.color, pch=16, xlim=c(-160,160),ylim=c(-160,140), xlab="", ylab="", axes=FALSE)
contour(est$x1, est$x2, est$fhat,  col = gray(.2), add=TRUE)
legend("topright", c(legend[1],legend[2]), pch = 17:18, col=c("#B2182B", "#2166AC"))
#text(-15000,25000,"Gobierno", cex=1.2, srt=0)
text(-140,115,paste("ENCG: ",ENCG,sep=""), cex=1, srt=0)
#text(jitter(l.rotated[,1],100),jitter(l.rotated[,2],100),my.label2, pos=3, cex=.6, col=gray(.1))
#segments(-5000,-40000,-5000,40000, col=2,lty=2)
#segments(-40000,-5000,40000,-5000, col=2,lty=2)
}
my.color <- brewer.pal(n=9, "RdBu")
RColorBrewer::display.brewer.all()
# Building a empty containes
temp <- rep(1,length(V(net)$membership))
new.color <- data.frame(t(col2rgb(temp)/255))
new.color <- rgb(new.color, alpha=.05)
#new.color <- my.color
new.color[V(net)$membership==2] <- my.color[1] ####
#new.color <- my.color
new.color[V(net)$membership==2] <- my.color[1] ####
#new.color[V(net)$membership==11] <- "gray" ####
new.color[V(net)$membership==4] <- my.color[9] ####
# Setting to the net
V(net)$new.color <- new.color
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Government", "Opposition"), title="Travel Ban")
png(filename ="TravelBanBasicMap_flipped.png", width = 8, height = 8, units = "in", pointsize = 12, bg = "white", res = 300)
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
load("Maldonado with equilibrium Results.RData")
V(net)$membership %>%
as.tibble() %>%
count(value)
my.color <- brewer.pal(n=9, "RdBu")
RColorBrewer::display.brewer.all()
# Building a empty containes
temp <- rep(1,length(V(net)$membership))
new.color <- data.frame(t(col2rgb(temp)/255))
new.color <- rgb(new.color, alpha=.05)
#new.color <- my.color
new.color[V(net)$membership==4] <- my.color[1] ####
#new.color[V(net)$membership==11] <- "gray" ####
new.color[V(net)$membership==1] <- my.color[9] ####
# Setting to the net
V(net)$new.color <- new.color
summary(net)
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
dev.off()
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
dev.off()
dev.off()
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
# Building a empty containes
temp <- rep(1,length(V(net)$membership))
new.color <- data.frame(t(col2rgb(temp)/255))
new.color <- rgb(new.color, alpha=.05)
#new.color <- my.color
new.color[V(net)$membership==4] <- my.color[9] ####
#new.color[V(net)$membership==11] <- "gray" ####
new.color[V(net)$membership==1] <- my.color[1] ####
# Setting to the net
V(net)$new.color <- new.color
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Travel Ban", "Anti-Travel Ban"), title="Travel Ban")
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Maldonado", "Anti-Maldonado"), title="Maldonado")
png(filename ="maldonado_flipped.png", width = 8, height = 8, units = "in", pointsize = 12, bg = "white", res = 300)
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Maldonado", "Anti-Maldonado"), title="Maldonado")
dev.off()
load("travelBan with  equilibrium Results.RData")
load("Bolsonaro with equlibrium Results.RData")
V(net)$membership %>%
as.tibble() %>%
count(value)
my.color <- brewer.pal(n=9, "RdBu")
RColorBrewer::display.brewer.all()
# Building a empty containes
temp <- rep(1,length(V(net)$membership))
new.color <- data.frame(t(col2rgb(temp)/255))
new.color <- rgb(new.color, alpha=.05)
#new.color <- my.color
new.color[V(net)$membership==2] <- my.color[9] ####
#new.color[V(net)$membership==11] <- "gray" ####
new.color[V(net)$membership==1] <- my.color[1] ####
# Setting to the net
V(net)$new.color <- new.color
summary(net)
dev.off()
dev.off()
my.den.plot(l=cbind(V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Bolsonaro", "Anti-Bolsonaro"), title="Bolsonaro")
my.den.plot(l=cbind(-1*V(net)$l1,V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Bolsonaro", "Anti-Bolsonaro"), title="Bolsonaro")
my.den.plot(l=cbind(V(net)$l1,-1*V(net)$l2),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Bolsonaro", "Anti-Bolsonaro"), title="Bolsonaro")
my.den.plot(l=cbind(V(net)$l2,V(net)$l1),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Pro-Bolsonaro", "Anti-Bolsonaro"), title="Bolsonaro")
my.den.plot(l=cbind(V(net)$l2,V(net)$l1),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Anti-Bolsonaro", "Pro-Bolsonaro"), title="Bolsonaro")
png(filename ="bolsonaro_flipped.png", width = 8, height = 8, units = "in", pointsize = 12, bg = "white", res = 300)
my.den.plot(l=cbind(V(net)$l2,V(net)$l1),new.color=V(net)$new.color, ind=V(net)$ind,
legend = c("Anti-Bolsonaro", "Pro-Bolsonaro"), title="Bolsonaro")
dev.off()

access_token_secret<-"OkaKXZ7W7Lo1zjlqtwVdxYiS9e2cXpEb2qQmzzX1SoFyG"
create_token(app=app_name,
consumer_key=consumer_key, consumer_secret=consumer_secret,
access_token = access_token, access_secret = access_token_secret)
vignette("auth", package = "rtweet")
# Ativar rtweet
#install.packages("rtweet") # somente uma vez
library(rtweet)
vignette("auth", package = "rtweet")
vignette("auth")
vignette('auth')
path <- "/home/venturat/Dropbox/CalvoTiago/mlogitRedes"
output <- "./output/Bolsonaro/"
setwd(path)
library(tidyverse)
library(igraph)
library(data.table)
library(arm)
library(broom)
library(RColorBrewer)
library(KernSmooth)
rm(list=ls(all=TRUE))
##PLOT FUNCTION
my.den.plot <- function(l=l,new.color=new.color, ind=ind, legend){
#Numero efectivo de Comunidades
ENCG<-round(1/sum(round(table(new.color)/sum(table(new.color)),3)^2),2)
est <- bkde2D(l, bandwidth=c(10, 10))
#temp<-as.numeric(factor(new.color))+15
plot(l,cex=log(ind+1)/4, col=new.color, pch=16, xlim=c(-160,160),ylim=c(-160,140), xlab="", ylab="", axes=FALSE)
contour(est$x1, est$x2, est$fhat,  col = gray(.2), add=TRUE)
legend("topright", c(legend[1],legend[2]), pch = 17:18, col=c("#B2182B", "#2166AC"))
#text(-15000,25000,"Gobierno", cex=1.2, srt=0)
text(-140,115,paste("ENCG: ",ENCG,sep=""), cex=1, srt=0)
#text(jitter(l.rotated[,1],100),jitter(l.rotated[,2],100),my.label2, pos=3, cex=.6, col=gray(.1))
#segments(-5000,-40000,-5000,40000, col=2,lty=2)
#segments(-40000,-5000,40000,-5000, col=2,lty=2)
}
fomfE<- function(var=var, adjV=adjV,adjE=adjE){
stemp <- sapply(adjE, function(x) sum(var[x]))
mstemp <- sapply(adjV, function(x) mean(stemp[x]))
plot(log(stemp),log(mstemp),ylim=c(0,max(log(mstemp),na.rm=TRUE)), xlim=c(0,max(log(stemp),na.rm=TRUE)), pch=16, cex=.4, col=gray(.5), xlab="Friends", ylab="Friends of Friends")
abline(0,1, col=2, lty=2)
out<-cbind(stemp,mstemp)
}
auth_chart <- function(data, x, y, color, destination) {
x <- enquo(x)
y <- enquo(y)
ggplot(data, aes(x=reorder(!!x,
!!y),
y=!!y)) +
geom_histogram(stat="identity", width=.5, color="black",
fill=color) +
theme_minimal(base_size = 22) +
coord_flip() +
xlab("") + ylab("")
ggsave(filename = destination,
width = 12, height = 12, units = "in",
pointsize = 22, bg = "white")
}
memory.limit(size=50000)
load("./data/bolsonaro_data_weightedmean.Rdata")
getwd()
load("parameters_ban.RData")
# plot
ls()
load("parameters_maldo.RData")
# plot
ls()
load("parameters_bolsonaro.RData")
#bind the data
res_id <- bind_rows(results_bolsonaro, results_maldo, results_ban)
res_id %>% filter(parameter=="ideology") %>%
ggplot(., aes(y=value, x=factor(quantile), fill=case))+
geom_point(alpha=1, size=4,  shape=21,
position=position_dodge(width=1)) +
geom_errorbar(aes(ymax=upper, ymin= lower), colour="black",
alpha=1, width=.5,
position=position_dodge(width=1)) +
ylab("") +
labs(title = "Ideology by quantile \n") +
theme_bw() +
theme(plot.title = element_text(size = 32, face = "bold"),
plot.subtitle = element_text(size=22),
axis.title=element_text(size=16),
legend.position = "bottom",
axis.title.x = element_text(hjust = 1),
legend.text =  element_text(size=22),
strip.text.y = element_text(size = 16, face="bold")) +
xlab("Quantiles") +
geom_hline(aes(yintercept = 0.0), color = 'tomato2', linetype="dotted") +
scale_fill_discrete(name="") +
facet_grid(case~.)
res_id %>% filter(parameter=="attention") %>%
ggplot(., aes(y=value, x=factor(quantile), fill=case))+
geom_point(alpha=1, size=4,  shape=21,
position=position_dodge(width=1)) +
geom_errorbar(aes(ymax=upper, ymin= lower), colour="black",
alpha=1, width=.5,
position=position_dodge(width=1)) +
ylab("") +
labs(title = "Attention by quantile \n") +
theme_bw() +
theme(plot.title = element_text(size = 32, face = "bold"),
plot.subtitle = element_text(size=22),
axis.title=element_text(size=16),
legend.position = "bottom",
axis.title.x = element_text(hjust = 1),
legend.text =  element_text(size=22),
strip.text.y = element_text(size = 16, face="bold")) +
xlab("Quantiles") +
geom_hline(aes(yintercept = 0.0), color = 'tomato2', linetype="dotted") +
scale_fill_discrete(name="") +
facet_grid(case~.)
load("Bolsonaro with equlibrium Results.RData")
ls()
a.repu <- coef(pois.lmer)$.time_1[,1]
se.rep <- se.coef(pois.lmer)$.time_1[,1]
a.repu <- coef(pois.lmer_bolsonaro)$.time_1[,1]
se.rep <- se.coef(pois.lmer_bolsonaro)$.time_1[,1]
a.repu <- coef(pois.lmer_bolsonaro)$.time_1[,1]
pois.lmer_bolsonaro <- pois.lmer
a.repu <- coef(pois.lmer_bolsonaro)$.time_1[,1]
se.rep <- se.coef(pois.lmer_bolsonaro)$.time_1[,1]
colnames(resultsNews1)
resultsnews_bolsonaro <- resultsNews1
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value)
names <- colnames(resultsNews1)
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
results_reputation
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be")))
View(results_reputation)
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
load("Maldonado with equilibrium Results.Rdata")
load("Maldonado with equilibrium Results.Rdata")
# Maldonado
getwd()
load("Maldonado with equilibrium Results.Rdata")
list.files()
load("Maldonado with equilibrium Results.RData")
pois.lmer_m <- pois.lmer
resultsnews_m <- resultsNews1
resultsnews_m
resultsnews_m <- colnames(resultsNews1)
resultsnews_m
a.repu <- coef(pois.lmer_m)$.time_1[,1]
se.rep <- se.coef(pois.lmer_m)$.time_1[,1]
names <- colnames(resultsnews_m)
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
a.repu
se.rep
a.repu
names
names <- colnames(resultsNews1)
resultsnews_m <- resultsNews1
names <- colnames(resultsnews_m)
names
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be")))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be|fb.me")))
View(results_reputation)
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
a.repu <- coef(pois.lmer_bolsonaro)$.time_1[,1]
se.rep <- se.coef(pois.lmer_bolsonaro)$.time_1[,1]
names <- colnames(resultsNews1)
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be")))
View(results_reputation)
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be")))
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
a.repu <- coef(pois.lmer_bolsonaro)$.time_1[,1]
se.rep <- se.coef(pois.lmer_bolsonaro)$.time_1[,1]
names <- colnames(resultsnews_bolsonaro)
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be")))
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
ggsave("parameters_reputation_bolsonaro.png", width = 12, height = 12, units = "in", pointsize = 22, bg = "white")
a.repu <- coef(pois.lmer_m)$.time_1[,1]
se.rep <- se.coef(pois.lmer_m)$.time_1[,1]
names <- colnames(resultsnews_m)
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be|fb.me")))
View(results_reputation)
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
ggsave("parameters_reputation_maldonado.png", width = 12, height = 12, units = "in", pointsize = 22, bg = "white")
load("travelBan with  equilibrium Results.Rdata")
load("travelBan with equilibrium Results.Rdata")
list.files()
load("travelBan with  equilibrium Results.RData")
a.repu <- coef(pois.lmer_m)$.time_1[,1]
pois.lmer_ban <- pois.lmer
resultsnews_ban <- resultsNews1
a.repu <- coef(pois.lmer_ban)$.time_1[,1]
se.rep <- se.coef(pois.lmer_ban)$.time_1[,1]
names <- colnames(resultsnews_ban)
names
results_reputation <- tibble(value=a.repu, se=se.rep, media=names) %>%
mutate(upper=value + 1.96*se,
lower=value - 1.96*se) %>%
arrange(value) %>%
mutate(media=fct_inorder(media))
results_reputation <- results_reputation  %>% filter(!(str_detect(media, "twitter.com|youtu.be|fb.me")))
ggplot(results_reputation,
aes(y=value, x=media, ymax=upper, ymin= lower)) +
geom_pointrange(color="steelblue", fill="white", shape=21, size=1) +
ylab("") +
labs(title = "") +
theme_minimal() +
theme(plot.title = element_text(size = 22, face = "bold"),
axis.title=element_blank(),
axis.title.x = element_text(hjust = 1),
axis.text = element_text(size=14),
legend.position = "bottom",
legend.text=element_text(size=14)) +
geom_hline(aes(yintercept = median(results_reputation$value),
color="Median Reputation"),
linetype="twodash", size=1) +
scale_fill_discrete(name="") +
coord_flip() +
scale_color_manual(name = "",
values = c('Median Reputation'= "red"))
ggsave("parameters_reputation_ban.png", width = 12, height = 12, units = "in", pointsize = 22, bg = "white")
results_reputation$value
load("~/Downloads/clea.complete.RData")
library(tidyverse)
table(clea.complete$cst)
my.data<-clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat)
encp=1/sum(pvs1^2)
lnv= log(pvs1/(1-pvs1)))
my.data<-clea.complete %>%
my.data<-clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2)
lnv= log(pvs1/(1-pvs1)))
my.data<-clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2),
lnv= log(pvs1/(1-pvs1)))
my.data<-clea.complete %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2),
lnv= log(pvs1/(1-pvs1)))
my.data
my.data<-clea.complete %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2),
lnv= log(pvs1/(1-pvs1)))
my.data<-clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2),
lnv= log(pvs1/(1-pvs1)))
my.data
clea.complete
clea.complete %>%
ungroup() %>%
group_by(cst)
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat)),
lnv= log(pvs1/(1-pvs1)))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
lnv= log(pvs1/(1-pvs1)))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat)),
encp=(1/sum(pvs1^2)),
lnv= log(pvs1/(1-pvs1)))
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=(1/sum(pvs1^2)),
lnv= log(pvs1/(1-pvs1)))
my.data
clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=sum(pvs1^2))
clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2))
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2),
lnv= log(pvs1/(1-pvs1)))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=sum(pvs1^2))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
summarise(k = sum(seat),
encp=1/sum(pvs1^2))
my.data
my.data<- clea.complete %>%
ungroup() %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2))
my.data
View(my.data)
my.data<- clea.complete %>%
my.data<- clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2)) %>%
ungroup() %>%
mutate(notwon=k-seat,
lnv= log(pvs1/(1-pvs1)))
View(my.data)
my.data<- clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2)) %>%
ungroup() %>%
mutate(notwon=k-seat,
lnv= log(pvs1/(1-pvs1))) %>%
select(lnv, notwon, k, encp)
View(my.data)
my.data<- clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2)) %>%
ungroup() %>%
mutate(notwon=k-seat,
lnv= log(pvs1/(1-pvs1))) %>%
select(lnv, notwon,seat, k, encp)
View(my.data)
my.data<- clea.complete %>%
group_by(cst) %>%
mutate(k = sum(seat),
encp=1/sum(pvs1^2)) %>%
ungroup() %>%
mutate(notwon=k-seat,
lnv= log(pvs1/(1-pvs1))) %>%
select(cst, lnv, notwon,seat, k, encp)
View(my.data)
